

cbuffer MaterialBuffer : register(b0)
{
	float4 color;
};


cbuffer CameraBuffer : register(b1)
{
	float4 cameraPosition;
};

cbuffer LightBuffer : register(b2)
{
	float4 lightPosition;
};

Texture2D texDiffuse : register(t0);
Texture2D texNormal : register(t1);
SamplerState texSampler : register(s0);

struct PSIn
{
	float4 Pos  : SV_Position;
	float3 Normal : NORMAL;
	float2 TexCoord : TEX;
	float4 WorldPos : WorldPos;
};

//-----------------------------------------------------------------------------------------
// PixelShader: PSSceneMain
//-----------------------------------------------------------------------------------------
float4 PS_main(PSIn input) : SV_Target
{	

	float4 lightColor = { 1, 1, 1, 0 };
	float4 lightColorBlue = { 1, 1, 1, 0 };
	float4 difuseTexColor = texDiffuse.Sample(texSampler, input.TexCoord);

	//calculate lighting vectors
    float3 N = normalize(input.Normal);
    float3 V = normalize((float3) cameraPosition - (float3) input.WorldPos );
	
	float4 L = normalize(lightPosition - input.WorldPos);
    float3 R = reflect( (float3) L, N);

	
	float4 Ia = color * saturate(1.0);
    float4 Id = difuseTexColor * saturate(dot(N,L));
    float4 Is = lightColorBlue * pow( saturate(dot(R,V)), 10 ); 
 
    return Ia + Id + Is;

	

}

